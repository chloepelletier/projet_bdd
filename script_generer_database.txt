DROP DATABASE basketballer;
create database basketballer;
use basketballer;
show tables;

/*Tables d'entités:
*/

CREATE TABLE equipe (num_equipe int, nom_equipe char(20), ville char(20), pays char(20), 
	fondation date, PRIMARY KEY(num_equipe));

CREATE TABLE joueur (id_joueur int, prenom char(20),
	nom_famille char(20), naissance date, taille_ft  real, poids_lbs real,
	role char(20), est_droitier bool, dist_bras_ft real,
	PRIMARY KEY(id_joueur));

CREATE TABLE partie (annee int, num_partie int, ville char(20), date_partie date,
	PRIMARY KEY(annee, num_partie));
/*DF date_partie -> annee.
  Ajouter est_serie bool ? (Redondant)
*/

CREATE TABLE serie (annee int, num_serie int, PRIMARY KEY(annee, num_serie));

CREATE TABLE appartient(annee int, num_partie int, num_serie int, num_sous_serie int,
	PRIMARY KEY(annee, num_partie),
	FOREIGN KEY(annee, num_partie) REFERENCES partie(annee, num_partie),
	FOREIGN KEY(annee, num_serie) REFERENCES serie(annee, num_serie));

CREATE TABLE type_action(type char(20), PRIMARY KEY(type));
INSERT INTO type_action VALUES ("lancer"), ("revirement"), ("faute"), ("rebond");

CREATE TABLE action (annee int, num_partie int, instant time, type_action char(20),
	PRIMARY KEY(annee, num_partie, instant),
	FOREIGN KEY(annee, num_partie) REFERENCES partie(annee, num_partie),
	FOREIGN KEY(type_action) REFERENCES type_action(type));

CREATE TABLE lancer (annee int, num_partie int, instant time, type_lancer char(20),
	PRIMARY KEY(annee, num_partie, instant),
	FOREIGN KEY(annee, num_partie, instant) REFERENCES action(annee, num_partie, instant),
	ON DELETE CASCADE);

CREATE TABLE panier (annee int, num_partie int, instant time,
	PRIMARY KEY(annee, num_partie, instant),
	FOREIGN KEY(annee, num_partie, instant) REFERENCES lancer(annee, num_partie, instant));

CREATE TABLE assiste(id_joueur int, annee int, num_partie int, instant time,
	PRIMARY KEY(annee, num_partie, instant),
	FOREIGN KEY(annee, num_partie, instant) REFERENCES panier(annee, num_partie, instant),
	FOREIGN KEY(id_joueur) REFERENCES joueur(id_joueur));

CREATE TRIGGER

CREATE TABLE revirement (annee int, num_partie int, instant time, type_revirement char(20),
	PRIMARY KEY(annee, num_partie, instant),
	FOREIGN KEY(annee, num_partie, instant) REFERENCES action(annee, num_partie, instant),
	ON DELETE CASCADE);

CREATE TABLE faute (annee int, num_partie int, instant time, type_faute char(20),
	PRIMARY KEY(annee, num_partie, instant),
	FOREIGN KEY(annee, num_partie, instant) REFERENCES action(annee, num_partie, instant),
	ON DELETE CASCADE);

CREATE TABLE rebond (annee int, num_partie int, instant time, type_rebond char(20),
	PRIMARY KEY(annee, num_partie, instant),
	FOREIGN KEY(annee, num_partie, instant) REFERENCES action(annee, num_partie, instant),
	ON DELETE CASCADE);



