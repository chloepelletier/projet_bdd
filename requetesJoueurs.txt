/*requetes pour joueur */

cmd = 'SELECT MAX(annee) FROM partie;'
cur.execute(cmd)
saison_courante = cur.fetchone()[0]

/* Nombre de match joués dans la saison. Enregistré dans variable nb_partie */
cmd='SELECT COUNT(*), SUM(P.minutes)
	FROM participe P
	WHERE P.id_joueur = +id+ AND P.annee=saison_courante;'
cur.execute(cmd)
infoParticipe = cur.fetchone()
nb_partie = infoParticipe[0]
nb_minute = infoParticipe[1]
moy_min = nb_minute /nb_partie


/* Moyenne des assists  par partie */
cmd='SELECT COUNT(*)
	FROM  assiste A
	WHERE A.annee='+saison_courante+' AND A.id_joueur='+id+';'
cur.execute(cmd)
nb_assiste = cur.fetchone()[0]
moy_assiste = nb_asssite / nb_partie

cmd = 'SELECT *
	FROM  action A
	WHERE A.annee='+saison_courante+' AND A.id_joueur='+id+';'
cur.execute(cmd)
action = cur.fetchall()

/*Moyenne des rebonds par partie */
nb_rebond = 0
for Tuple in action
	If Tuple[3] = "rebond"
		nb_rebond +=1
moy_rebond = nb_rebond / nb_partie


/* Moyenne des fautes par partie */	
nb_faute = 0
for Tuple in action
	If Tuple[3] = "faute"
		nb_faute +=1
moy_faute = nb_faute / nb_partie
/*pourrait faire en meme temps que rebond */


nb_revirement_p = 0
nb_revirement_n = 0
nb_lancer_1pt = 0
nb_lancer_2pt = 0
nb_lancer_3pt = 0
nb_panier_1pt = 0
nb_panier_2pt = 0
nb_lancer_3pt = 0
for Tuple in action
	if Tuple[3] = "lancer"
		cmd = 'SELECT R.type_lancer, R.est_panier
			FROM lancer L
			WHERE L.annee='+Tuple[0]+' AND L.num_partie='+Tuple[1]+' AND L.instant= '+Tuple[2]+';'
		cur.execute(cmd)
		lancer = cur.fetchone()
			if lancer[0] = "1pt"
				nb_lancer_1pt +=1
				if (lancer[1])
					nb_panier_1pt +=1
			elseif lancer[0] = "2pt"
				nb_lancer_2pt +=1
				if (lancer[1])
					nb_panier_2pt +=1
			elseif lancer[0] = "3pt"
				nb_lancer_3pt +=1
				if (lancer[1])
					nb_panier_3pt +=1
			else
				raise ValueError('lancer ni 1, ni 2, ni 3 pt')
		
	if Tuple[3] = "revirement"
		cmd = 'SELECT R.type_revirement
			FROM revirement R
			WHERE R.annee='+Tuple[0]+' AND R.num_partie='+Tuple[1]+' AND R.instant= '+Tuple[2]+';'
		cur.execute(cmd)
		revirement = cur.fetchone()
		if revirement[0] = "offensif"
			nb_revirement_p +=1
		elseif revirement[0] = "defensif"
			nb_revirement_n +=1
		else
			raise ValueError('revirement ni offsensif, ni defensif')
moy_vol_balle = nb_revirement_p / nb_partie
moy_revirement = nb_revirement_n / nb_partie
nb_point =  1*nb_panier_1pt + 2*nb_panier_2pt +3*nb_panier_3pt
moy_point = nb_point / nb_partie
pourcentage_lancer_franc = nb_paner_1pt / nb_lancer_1pt
pourcentage_2pt = nb_paner_2pt / nb_lancer_2pt
pourcentage_3pt = nb_paner_3pt / nb_lancer_3pt

/*fin requêtes pour joueur */